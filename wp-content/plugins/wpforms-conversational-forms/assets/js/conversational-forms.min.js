"use strict";var WPFormsConversationalForms=window.WPFormsConversationalForms||function(e,s,o){var r,l,t,a,d,i,n,c,f;function h(){this.registered={},this.active=null}function p(e,t){this.$el=e,this.id=t,this.type=null,this.items=null,this.keyboard={enable:{},disable:{},active:{}},this.events={enable:{},active:{}},this.keyboardMobile={enable:{},disable:{},active:{}},this.eventsMobile={enable:{},active:{}},this.vars={},this.init()}function u(e){this.field=e,this.registered={},this.current=null}function v(e,t,i,n){this.$el=e,this.id=t,this.type=i,this.parentField=n,this.focusable=!1,this.scrollableTo=!1,this.highlighted=!1,this.keyboard={enable:{},disable:{},active:{}},this.events={enable:{},active:{}},this.keyboardMobile={enable:{},disable:{},active:{}},this.eventsMobile={enable:{},active:{}},this.vars={},this.init()}function m(e,t){a.Field.call(this,e,t)}function y(e,t){a.Field.call(this,e,t)}function b(e,t){a.Field.call(this,e,t)}function g(e,t){a.Field.call(this,e,t)}function w(e,t){a.Field.call(this,e,t),this.keyboard.enable={shiftEnter:{$el:o(s),handler:"keydown",fn:function(e){13===e.keyCode&&e.shiftKey&&(e.preventDefault(),this.$el.find("input").trigger("click"),this.$el.find(".wpforms-uploader").trigger("click"))}}},this.events.enable={changeFile:{$el:this.$el.find('input[type="file"]'),handler:"change",fn:function(e){var t=this.$el.find('input[type="file"]').get(0);!t.files||1!==t.files.length||(e=e.target.value.split("\\").pop())&&(o(t).nextAll(".wpforms-field-file-upload-file-name").text(e),c.scroll.next())}}},this.eventsMobile.enable={changeFile:this.events.enable.changeFile}}function $(e,t){a.Field.call(this,e,t),this.keyboard.disable={enter:c.globalEvents.keyboard.enter},this.keyboard.enable={alphabet:{$el:o(s),handler:"keydown",fn:function(e){var t=this.$el.find('input[type="checkbox"]'),e=e.keyCode-65;t[e]&&o(t[e]).trigger("click")}},enter:{$el:o(s),handler:"keydown",fn:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),c.fields.callOnActive("isCurrentHighlighted")&&c.fields.active.items.selectCurrent())}},shiftEnter:{$el:o(s),handler:"keydown",fn:function(e){13===e.keyCode&&e.shiftKey&&(e.preventDefault(),c.scroll.next())}}}}function k(e,t){a.Field.call(this,e,t),this.keyboard.disable={up:c.globalEvents.keyboard.up,down:c.globalEvents.keyboard.down},this.keyboard.enable={up:{$el:o(s),handler:"keydown",fn:function(e){38===e.keyCode&&0===o(e.target).prop("selectionStart")&&c.scroll.prev()}},down:{$el:o(s),handler:"keydown",fn:function(e){40===e.keyCode&&o(e.target).val().length===o(e.target).prop("selectionStart")&&c.scroll.next()}}},this.events.enable={userInput:{$el:this.$el.find("textarea"),handler:"input paste",fn:function(){var e=this.$el.find("textarea"),t=e.innerHeight()-e.height();e.innerHeight<e.get(0).scrollHeight||e.height(1),e.height(e.get(0).scrollHeight-t)}}},this.eventsMobile.enable={userInput:this.events.enable.userInput}}function C(e){a.FieldItemsSet.call(this,e)}function x(e){a.FieldItemsSet.call(this,e)}function E(e){a.FieldItemsSet.call(this,e)}function F(e){a.FieldItemsSet.call(this,e)}function I(e){a.FieldItemsSet.call(this,e)}function T(e,t,i,n){a.FieldItem.call(this,e,t,i,n)}function j(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.events.enable={change:{$el:this.$el,handler:"change",fn:function(e){if(e.preventDefault(),"radio"===e.target.type)try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}}}}}function A(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.loadInputMask()}function M(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.$el.attr("data-rule-wpforms-conversational-forms-date","true"),this.loadInputMask()}function O(e,t,i,n){a.FieldItem.call(this,e,t,i,n)}function D(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.eventsMobile.enable={change:{$el:this.$el,handler:"change",fn:function(){try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}}}}}function H(e,t,i,n){this.elements={},a.FieldItem.call(this,e,t,i,n),this.keyboard.disable={up:c.globalEvents.keyboard.up,down:c.globalEvents.keyboard.down,enter:c.globalEvents.keyboard.enter,space:c.globalEvents.keyboard.space},this.keyboard.enable={up:{$el:o(s),handler:"keydown",fn:function(e){if(38===e.keyCode)if(this.dropdownIsOpened()){e.preventDefault();var t,i=this.elements.$items.filter(":visible"),n=i.filter(function(){return o(this).hasClass("selected")});i.removeClass("selected"),(t=(t=!n.length?i.last().addClass("selected"):t)||n.prevAll(".wpforms-conversational-form-dropdown-item:visible")).length||(t=i.last()),this.scrollItemIntoView(t),t.first().addClass("selected")}else try{c.fields.active.items.highlightPrev().fail(c.scroll.prev)}catch(e){c.scroll.prev()}}},down:{$el:o(s),handler:"keydown",fn:function(e){var t,i;40===e.keyCode&&(e.preventDefault(),this.dropdownIsOpened()?(e=(t=this.elements.$items.filter(":visible")).filter(function(){return o(this).hasClass("selected")}),t.removeClass("selected"),(i=(i=!e.length?t.first().addClass("selected"):i)||e.nextAll(".wpforms-conversational-form-dropdown-item:visible")).length||(i=t.first()),this.scrollItemIntoView(i),i.first().addClass("selected")):this.dropdownOpen(!0))}},enter:{$el:o(s),handler:"keydown",fn:function(e){13===e.keyCode&&(e.preventDefault(),this.dropdownIsOpened()?(e=!(e=this.elements.$items.filter(".selected:visible"))||!e.length?this.elements.$items.filter(":visible"):e)&&e.length?e.first().trigger("click"):this.dropdownClose():c.scroll.next())}},esc:{$el:o(s),handler:"keydown",fn:function(e){27===e.keyCode&&this.dropdownClose()}}},this.events.enable={keyboardInput:{$el:this.$el,handler:"keyup",fn:function(e){-1===[13,27,38,40].indexOf(e.keyCode)&&this.dropdownOpen()}},optionClick:{$el:this.elements.$items,handler:"click",fn:function(e){var i=o(e.target).data("value"),t=this.elements.$options.filter(function(e,t){return o(t).val().toString()===i.toString()});t.length&&(this.$el.val(t.first().text()),this.elements.$select.val(t.first().val()).trigger("change"),this.elements.$selected=t.first()),this.dropdownClose();try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}}},chevronClick:{$el:this.$el.siblings(".fa-chevron-down"),handler:"click",fn:function(){this.dropdownIsOpened()?this.dropdownClose():this.dropdownOpen(!0)}},blur:{$el:this.$el,handler:"wpformsConvFormsFieldItemBlur",fn:function(){this.dropdownClose()}}}}function P(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.events.enable={change:{$el:this.$el,handler:"change",fn:c.scroll.next}},this.eventsMobile.enable={change:this.events.enable.change}}function S(e,t,i,n){a.FieldItem.call(this,e,t,i,n)}return r={page:o("#wpforms-conversational-form-page"),form:o(".wpforms-form"),header:o(".wpforms-conversational-form-header"),phpErrorContainer:o(".wpforms-error-container"),fields:o(".wpforms-field-container .wpforms-field"),fieldsErrors:o(".wpforms-field-container .wpforms-field .wpforms-error"),recaptchaContainer:o(".wpforms-recaptcha-container"),footer:o(".wpforms-submit-container"),progress:{bar:o(".wpforms-conversational-form-footer-progress-completed"),completed:o(".wpforms-conversational-form-footer-progress-status .completed"),totalCount:o(".wpforms-conversational-form-footer-progress-status .completed-of")}},l={string:{toCapitalizedCamelCase:function(e){return e&&"string"==typeof e?e.replace(/[\s-_](.)/g,function(e){return e.toUpperCase()}).replace(/[\s-_]/g,"").replace(/^(.)/,function(e){return e.toUpperCase()}):e}},object:{isEmpty:function(e){return"object"!=typeof e||!Object.keys(e).length},findSequentialKey:function(e,t,i){i=i||0;var n,s=Object.keys(e),i=s[s.indexOf(t.toString())+i];return n=i in e?e[i]:n},findNextKey:function(e,t){return l.object.findSequentialKey(e,t,1)},findPrevKey:function(e,t){return l.object.findSequentialKey(e,t,-1)},findFirstKey:function(e){return l.object.getKeyByNumIndex(e,0)},findLastKey:function(e){return l.object.getKeyByNumIndex(e,Object.keys(e).length-1)},getNumKeyIndex:function(e,t){return Object.keys(e).indexOf(t.toString())},getKeyByNumIndex:function(e,t){t=t||0;var i,t=Object.keys(e)[t];return i=t in e?e[t]:i}},class:{extend:function(t,e){var i=t.prototype;t.prototype=Object.create(e.prototype),Object.keys(i).forEach(function(e){t.prototype[e]=i[e]}),(t.prototype.constructor=t).superclass=e.prototype,e.prototype.constructor===Object.prototype.constructor&&(e.prototype.constructor=e)}},misc:{debounce:function(n,s,o){var r;return function(){var e=this,t=arguments,i=o&&!r;clearTimeout(r),r=setTimeout(function(){r=null,o||n.apply(e,t)},s),i&&n.apply(e,t)}}}},f={baseline:(f=3,("ontouchstart"in s||0<s.navigator.maxTouchPoints)&&(f=5),s.innerHeight/f),isTop:function(){return 0===o(s).scrollTop()},top:function(){r.page.addClass("wpforms-conversational-form-start"),c.scroll.to(r.header)},start:function(){var e;for(r.page.removeClass("wpforms-conversational-form-start"),e=l.object.findFirstKey(c.fields.registered);e&&!e.$el.is(":visible");)e=l.object.findNextKey(c.fields.registered,e.id);e&&c.scroll.to(e)},finish:function(){(!c.fields.active||c.fields.active.validate())&&c.scroll.to(r.footer)},next:function(){(!c.fields.active||!c.fields.active.$el.hasClass("wpforms-field-select"))&&c.fields.active&&c.fields.active.$el.hasClass("wpforms-conditional-trigger")?o(s.document).one("wpformsProcessConditionals",c.scroll.processNext):c.scroll.processNext()},processNext:function(){var e=c.fields.findNext();(e||!r.page.hasClass("wpforms-conversational-form-start"))&&(e||!c.fields.isAtBaseline(r.header))?!e&&c.fields.isAtBaseline(r.footer)||(e?c.fields.active.validate()&&c.scroll.to(e):c.scroll.finish()):c.scroll.start()},prev:function(){var e=c.fields.findPrev();if(e||!c.fields.isAtBaseline(r.header)){if(!e&&c.fields.isAtBaseline(r.footer))for(e=l.object.findLastKey(c.fields.registered);e&&!e.$el.is(":visible");)e=l.object.findPrevKey(c.fields.registered,e.id);e&&c.scroll.to(e)}},before:function(){o(s).off("scroll",c.scroll.passive),c.unmapAllGlobalEvents()},after:function(){c.mapAllGlobalEvents(),c.fields.callOnActive("activate"),o(s).on("scroll",c.scroll.passive),c.updateProgressBar()},animate:function(e){if(!e||!e.length)return o.Deferred().resolve();e=e.offset().top-c.scroll.baseline+1;return c.scroll.before(),o("html, body").animate({scrollTop:e},350).promise().then(c.scroll.after)},to:function(e){var t=e.$el||e;if(t&&t.length)return c.fields.updateActive(e,!0),e instanceof a.Field&&e.items.current&&(t=e.items.current.$el),c.scroll.animate(t)},passive:function(){var e,t=o(s).scrollTop();c.fields.active||c.fields.updateActive(),0!==t&&(0<t&&r.page.hasClass("wpforms-conversational-form-start")?c.scroll.start():c.fields.active&&((e=c.fields.active.$el.offset().top-c.scroll.baseline)+c.fields.active.$el.outerHeight(!0)<t&&c.fields.updateActive(c.fields.findNext()),t<e&&c.fields.updateActive(c.fields.findPrev()),setTimeout(function(){c.fields.active&&!c.fields.isAtBaseline(c.fields.active)&&c.fields.updateActive()},100)))}},t={obj:null,eventType:null,unmapDisabledEvents:function(){l.object.isEmpty(this.obj[this.eventType].disable)||o.each(this.obj[this.eventType].disable,function(e){if(void 0===this.obj[this.eventType].disable[e])return!0;this.obj[this.eventType].disable[e].$el.off(this.obj[this.eventType].disable[e].handler,this.obj[this.eventType].disable[e].fn)}.bind(this))},mapDisabledEvents:function(){l.object.isEmpty(this.obj[this.eventType].disable)||o.each(this.obj[this.eventType].disable,function(e){if(void 0===this.obj[this.eventType].disable[e])return!0;this.obj[this.eventType].disable[e].$el.on(this.obj[this.eventType].disable[e].handler,this.obj[this.eventType].disable[e].fn)}.bind(this))},mapEnabledEvents:function(){l.object.isEmpty(this.obj[this.eventType].enable)||o.each(this.obj[this.eventType].enable,function(e){if("undefined"===this.obj[this.eventType].active[e])return!0;this.obj[this.eventType].active[e]=this.obj[this.eventType].enable[e],this.obj[this.eventType].active[e].fn=this.obj[this.eventType].enable[e].fn.bind(this.obj),this.obj[this.eventType].active[e].$el.on(this.obj[this.eventType].active[e].handler,this.obj[this.eventType].active[e].fn)}.bind(this))},unmapEnabledEvents:function(){l.object.isEmpty(this.obj[this.eventType].active)||(o.each(this.obj[this.eventType].active,function(e){if("undefined"===this.obj[this.eventType].active[e])return!0;this.obj[this.eventType].active[e].$el.off(this.obj[this.eventType].active[e].handler,this.obj[this.eventType].active[e].fn)}.bind(this)),this.obj[this.eventType].active={})},mapEvents:function(e,t){e&&t&&t in e&&(this.obj=e,this.eventType=c.isMobileDevice()?t+"Mobile":t,l.object.isEmpty(this.obj[this.eventType])||(this.unmapDisabledEvents(),this.mapEnabledEvents()))},unmapEvents:function(e,t){e&&t&&t in e&&(this.obj=e,this.eventType=c.isMobileDevice()?t+"Mobile":t,l.object.isEmpty(this.obj[this.eventType])||(this.unmapEnabledEvents(),this.mapDisabledEvents()))}},a={FieldItem:(v.prototype.mapEvents=function(){this.events.enable.clickActivate={$el:this.$el,handler:"mousedown",fn:function(e){var t;this.parentField.items&&this.parentField.items.current&&void 0!==this.id&&this.id in this.parentField.items.registered&&this.id!==this.parentField.items.current.id&&(t=this.parentField.items.registered[this.id],this.parentField.items.current.fadeOut(),this.parentField.items.setCurrent(t),c.scroll.animate(t.$el).then(t.fadeIn.bind(this)))}},this.eventsMobile.enable.clickActivate=this.events.enable.clickActivate,t.mapEvents(this,"events")},v.prototype.unmapEvents=function(){t.unmapEvents(this,"events")},v.prototype.isFocusable=function(){var e=this.$el.prop("tagName"),t=this.$el.prop("type");return"hidden"!==t&&(!(-1<["checkbox","radio"].indexOf(t))&&-1<["INPUT","TEXTAREA","SELECT"].indexOf(e))},v.prototype.isScrollableTo=function(){var e=this.$el.prop("type");return-1<["checkbox","radio"].indexOf(e)||!this.$el.parent().hasClass("wpforms-conversational-form-dropdown-input")&&this.isFocusable()},v.prototype.focus=function(){this.focusable&&!c.isMobileDevice()&&this.$el.get(0).focus({preventScroll:!0}),t.mapEvents(this,"keyboard"),this.$el.trigger("wpformsConvFormsFieldItemFocus",this)},v.prototype.blur=function(){this.focusable&&this.$el.blur(),t.unmapEvents(this,"keyboard"),this.$el.trigger("wpformsConvFormsFieldItemBlur",this)},v.prototype.addHTML=function(){},v.prototype.removeHTML=function(){this.parentField.$el.find(".wpforms-conversational-field-item-additional-html").remove()},v.prototype.getHoverEl=function(){return this.$el},v.prototype.addHover=function(){var e=this.getHoverEl();e&&e.addClass("wpforms-field-item-hover")},v.prototype.removeHover=function(){var e=this.getHoverEl();e&&e.removeClass("wpforms-field-item-hover")},v.prototype.fadeIn=function(){this.highlighted||this.focusable||(this.highlighted=!0,this.addHover()),this.focus(),c.isMobileDevice()||this.addHTML()},v.prototype.fadeOut=function(){this.highlighted&&!this.focusable&&(this.highlighted=!1,this.removeHover()),this.blur(),c.isMobileDevice()||this.removeHTML()},v.prototype.getValidateEl=function(){return this.$el},v.prototype.validate=function(e,t){return void 0===o.fn.validate||(!(e=e||r.form.data("validator"))||(!this.focusable&&!t||e.element(this.getValidateEl())))},v.prototype.init=function(){this.focusable=this.isFocusable(),this.scrollableTo=this.isScrollableTo()},v),FieldItemsSet:(u.prototype.findElements=function(){return this.field.$el.find("input, textarea, select")},u.prototype.identifyItemType=function(e){return(e=!e&&this.current?this.current.$el:e)?e.prop("type"):""},u.prototype.updateRegistered=function(){var e;!this.field.$el||(e=this.findElements()).length&&e.each(function(e,t){var i=this.field.id+"-"+e,n=this.identifyItemType(o(t));if("hidden"===n)return!0;var s=l.string.toCapitalizedCamelCase(n),e=a.FieldItem;s in d.fieldItem&&(e=d.fieldItem[s]),c.isMobileDevice()&&"SelectOne"===s&&(e=d.fieldItem.SelectMobile),this.registered[i]=new e(o(t),i,n,this.field)}.bind(this))},u.prototype.setCurrent=function(e){this.current&&this.current.fadeOut(),e?e instanceof a.FieldItem&&(this.current=e):this.current=null},u.prototype.setCurrentFirst=function(){var e=l.object.findFirstKey(this.registered);e&&this.setCurrent(e)},u.prototype.setCurrentLast=function(){var e=l.object.findLastKey(this.registered);e&&this.setCurrent(e)},u.prototype.initCurrent=function(){var e;this.current||(e=l.object.findFirstKey(this.registered))&&this.setCurrent(e)},u.prototype.selectCurrent=function(){this.current&&this.current instanceof a.FieldItem&&this.current.$el.trigger("click")},u.prototype.isCurrentHighlighted=function(){return!!this.current&&Boolean(this.current.highlighted)},u.prototype.findNext=function(){if(!this.current)return!1;for(var e=l.object.findNextKey(this.registered,this.current.id);e&&!e.$el.is(":visible");)e=l.object.findNextKey(this.registered,e.id);return e},u.prototype.findPrev=function(){if(!this.current)return!1;for(var e=l.object.findPrevKey(this.registered,this.current.id);e&&!e.$el.is(":visible");)e=l.object.findPrevKey(this.registered,e.id);return e},u.prototype.highlightNext=function(){var e=new o.Deferred;if(!this.current)return e.reject();if(!this.current.focusable&&!this.current.highlighted)return this.setCurrentFirst(),this.current.fadeIn(),e.resolve();var t=this.findNext();return t?this.current.validate()?(this.current.fadeOut(),this.current=t,this.current.scrollableTo?c.scroll.animate(this.current.$el).then(function(){this.current.fadeIn(),e.resolve()}.bind(this)):(this.current.fadeIn(),e.resolve()),e):e.resolve():e.reject()},u.prototype.highlightPrev=function(){var e=new o.Deferred;if(!this.current)return e.reject();if(!this.current.focusable&&!this.current.highlighted)return this.setCurrentLast(),this.current.fadeIn(),e.resolve();var t=this.findPrev();return t?(this.current.fadeOut(),this.current=t,this.current.scrollableTo?c.scroll.animate(this.current.$el).then(function(){this.current.fadeIn(),e.resolve()}.bind(this)):(this.current.fadeIn(),e.resolve()),e):e.reject()},u),Field:(p.prototype.mapEvents=function(){t.mapEvents(this,"keyboard"),t.mapEvents(this,"events"),o.each(this.items.registered,function(e,t){t.mapEvents()})},p.prototype.unmapEvents=function(){t.unmapEvents(this,"keyboard"),t.unmapEvents(this,"events"),o.each(this.items.registered,function(e,t){t.unmapEvents()})},p.prototype.focus=function(){this.items.current&&this.items.current.focus()},p.prototype.blur=function(){this.items.current&&this.items.current.fadeOut()},p.prototype.addHTML=function(){},p.prototype.removeHTML=function(){this.$el.find(".wpforms-conversational-field-additional-html").remove()},p.prototype.deactivate=function(){this.$el.removeClass("wpforms-conversational-form-field-active"),this.blur(),this.removeHTML(),this.unmapEvents()},p.prototype.activate=function(){this.$el.hasClass("wpforms-conversational-form-field-active")||(this.$el.trigger("wpformsConvFormsFieldActivationBefore",this),this.$el.addClass("wpforms-conversational-form-field-active"),this.mapEvents(),c.isMobileDevice()||this.addHTML(),this.focus(),this.$el.trigger("wpformsConvFormsFieldActivationAfter",this))},p.prototype.validate=function(){if(void 0===o.fn.validate)return!0;var i=r.form.data("validator");if(!i)return!0;var n=[];return o.each(this.items.registered,function(e,t){t.validate(i,!0)||n.push(e)}),this.$el.trigger("wpformsConvFormsFieldValidation",[n,this]),!n.length},p.prototype.getFieldItemsSetObj=function(){var e=l.string.toCapitalizedCamelCase(this.type),e=e in d.fieldItemsSet?d.fieldItemsSet[e]:a.FieldItemsSet;return new e(this)},p.prototype.init=function(){this.type=this.$el.data("field-type"),this.items=this.getFieldItemsSetObj(),this.items.updateRegistered(),this.items.initCurrent()},p),FieldsSet:(h.prototype.updateRegistered=function(){r.fields.each(function(e,t){var i=o(t).data("field-id"),n=o(t).data("field-type");if(void 0===i||!n)return!0;if("hidden"===n)return!0;i=i+"-"+n,n=l.string.toCapitalizedCamelCase(n);if((n=-1!==["PaymentCheckbox","GdprCheckbox"].indexOf(n="PaymentMultiple"===n?"Radio":n)?"Checkbox":n)in d.field)return this.registered[i]=new d.field[n](o(t),i),!0;this.registered[i]=new a.Field(o(t),i)}.bind(this))},h.prototype.isAtBaseline=function(e){if(r.page.hasClass("wpforms-conversational-form-start"))return!1;var t=e;if(!t)return!1;if(!(t=e instanceof a.Field?e.$el:t).is(":visible"))return!1;var i=o(s).scrollTop()+c.scroll.baseline,e=t.offset().top,t=e+t.outerHeight(!0);return e<=i&&i<=t},h.prototype.detectActive=function(){var i;return o.each(this.registered,function(e,t){if(this.isAtBaseline(t))return i=t,!1}.bind(this)),i},h.prototype.updateActive=function(e,t){this.clearActive(),(e=e||this.detectActive())&&e instanceof a.Field&&e.$el.length&&(this.active=e,t||e.activate()),t||c.updateProgressBar()},h.prototype.clearActive=function(){this.active&&this.active instanceof a.Field&&(this.active.deactivate(),this.active=null)},h.prototype.callOnActive=function(e){var t;if(this.active&&this.active instanceof a.Field&&(e in this.active&&(t=this.active),e in this.active.items&&(t=this.active.items),t&&t[e]instanceof Function))return t[e]()},h.prototype.findNext=function(){if(this.active){for(var e=l.object.findNextKey(this.registered,this.active.id);e&&!e.$el.is(":visible");)e=l.object.findNextKey(this.registered,e.id);return e}},h.prototype.findPrev=function(){if(this.active){for(var e=l.object.findPrevKey(this.registered,this.active.id);e&&!e.$el.is(":visible");)e=l.object.findPrevKey(this.registered,e.id);return e}},h.prototype.getVisible=function(){var i={};return o.each(this.registered,function(e,t){t.$el.is(":visible")&&(i[e]=t)}),i},h.prototype.getCompletedCount=function(e){var t;return this.isAtBaseline(r.header)?0:(e=e||this.getVisible(),this.isAtBaseline(r.footer)?Object.keys(e).length:(void 0!==(t=this.active?l.object.getNumKeyIndex(e,this.active.id):t)&&"-1"!==t&&t++,t||0))},h.prototype.getCompletedPercent=function(e,t){var i;return this.isAtBaseline(r.header)?0:this.isAtBaseline(r.footer)?100:(e=e||this.getVisible(),(i=void 0!==(t=t||this.getCompletedCount(e))&&"-1"!==t?Math.floor(100*t/Object.keys(e).length):i)||0)},h)},d={fieldItem:{Checkbox:(S.prototype.getHoverEl=function(){return this.$el.closest("li")},S),Radio:(P.prototype.getHoverEl=function(){var e;return-1!==["radio","payment-multiple"].indexOf(this.parentField.type)&&(e=this.$el.closest("li")),"rating"===this.parentField.type&&(e=this.$el.parent("label")),e="net_promoter_score"===this.parentField.type?this.$el.siblings("label"):e},P),SelectOne:(H.prototype.getValidateEl=function(){return this.elements.$select},H.prototype.init=function(){this.dropdownInit(),this.$el=this.elements.$container.find(".wpforms-conversational-form-dropdown-input input"),this.dropdownPopulateInitialValue(),this.type="select-input",this.focusable=this.isFocusable()},H.prototype.dropdownInit=function(){this.$el.wrap(o("<div></div>").addClass("wpforms-conversational-select").addClass(this.$el.attr("disabled")?"disabled":"")).before('<div class="wpforms-conversational-form-dropdown-input"><input type="text" class="wpforms-field-medium"><i class="fa fa-chevron-down"></i></div><div class="wpforms-conversational-form-dropdown-list-empty">'+wpforms_conversational_forms.i18n.select_list_empty+'</div><ul class="wpforms-conversational-form-dropdown-list"></ul><div class="wpforms-conversational-form-dropdown-list-helper">'+wpforms_conversational_forms.i18n.select_option_helper+"</div>").css({height:0,width:0,padding:0,border:0,display:"block"}),this.$el.find("[selected]").length||this.$el.prepend('<option value="" class="placeholder" disabled selected="selected">'+wpforms_conversational_forms.i18n.select_placeholder+"</option>"),this.elements={$select:this.$el,$container:this.$el.parent(".wpforms-conversational-select"),$options:this.$el.find("option"),$selected:this.$el.find("option:selected")},this.elements.$itemList=this.elements.$container.find(".wpforms-conversational-form-dropdown-list"),this.elements.$listEmpty=this.elements.$container.find(".wpforms-conversational-form-dropdown-list-empty").hide(),this.elements.$listHelper=this.elements.$container.find(".wpforms-conversational-form-dropdown-list-helper").hide(),this.elements.$options.each(function(e,t){t=o(t);if(t.hasClass("placeholder"))return!0;this.elements.$container.find("ul").append(o("<li></li>").attr("data-value",t.val()).addClass("wpforms-conversational-form-dropdown-item").addClass("option"+(t.is(":selected")?" selected":"")+(t.is(":disabled")?" disabled":"")).html(t.text()))}.bind(this)),this.elements.$items=this.elements.$itemList.find(".wpforms-conversational-form-dropdown-item")},H.prototype.dropdownPopulateInitialValue=function(){this.elements.$selected.hasClass("placeholder")?this.$el.attr("placeholder",this.elements.$selected.text()):this.$el.val(this.elements.$selected.text())},H.prototype.dropdownFilter=function(e){try{var i=new RegExp(e,"gi")}catch(e){return!1}return this.elements.$items.filter(function(e,t){return o(t).text().match(i)})},H.prototype.dropdownOpen=function(e){var t=this.$el.val();if(this.elements.$listEmpty.hide(),this.elements.$items.hide(),!(t=!e&&t?this.dropdownFilter(t):this.elements.$items).length)return this.elements.$itemList.addClass("opened"),this.elements.$listHelper.hide(),void this.elements.$listEmpty.show();t.show(),this.elements.$listHelper.show(),this.elements.$itemList.addClass("opened"),this.elements.$items.removeClass("selected"),t.first().addClass("selected"),this.elements.$itemList.scrollTop(0),o("body").css("overflow","hidden"),o("#wpforms-conversational-form-page").css("paddingRight","15px")},H.prototype.dropdownClose=function(){var e,i=this.$el.val();this.elements.$listHelper.hide(),this.elements.$listEmpty.hide(),i?(e=this.elements.$options.filter(function(e,t){return o(t).text()===i})).length?(this.elements.$select.val(e.first().val()),this.elements.$selected=e.first()):(this.$el.val(""),this.dropdownPopulateInitialValue()):this.dropdownPopulateInitialValue(),this.elements.$itemList.hide().removeClass("opened"),o("body").css("overflow","auto"),o("#wpforms-conversational-form-page").css("paddingRight","initial"),setTimeout(function(){this.elements.$itemList.show()}.bind(this),250)},H.prototype.dropdownIsOpened=function(){return!(!this.elements.$itemList||!this.elements.$itemList.length)&&this.elements.$itemList.hasClass("opened")},H.prototype.scrollItemIntoView=function(e){var t,i,n,s;(e=e.first())&&e.length&&(t=this.elements.$itemList.height(),s=this.elements.$itemList.scrollTop(),i=parseInt(this.elements.$itemList.css("padding-top"),10),n=e.outerHeight(),e=s+(s=e.position().top),s<0&&this.elements.$itemList.scrollTop(e-i),t<s+n&&this.elements.$itemList.scrollTop(e-(t-n)))},H),SelectMobile:(D.prototype.focus=function(){var e=this.$el;l.misc.debounce(function(){e.get(0).focus({preventScroll:!0}),t.mapEvents(this,"keyboard"),e.trigger("wpformsConvFormsFieldItemFocus",this)},5,!1)()},D),Url:(O.prototype.getValidateEl=function(){return this.$el.trigger("change"),this.$el},O),Date:(M.prototype.loadInputMask=function(){var e,t;void 0!==o.fn.inputmask&&(e="d/m/Y"===this.$el.data("date-format")?"dd/mm/yyyy":"mm/dd/yyyy",t=Object.create(null),o.extend(t,{alias:"datetime",inputFormat:e}),this.$el.inputmask(t))},M),Time:(A.prototype.loadInputMask=function(){var e,t;void 0!==o.fn.inputmask&&(e="H:i"===this.$el.data("time-format")?"HH:MM":"hh:MM TT",t=Object.create(null),o.extend(t,{alias:"datetime",inputFormat:e,placeholder:"_"}),this.$el.inputmask(t))},A),LikertRow:(j.prototype.validate=function(e){return void 0===o.fn.validate||(!(e=e||r.form.data("validator"))||e.element(this.getValidateEl()))},j.prototype.addHTML=function(){var e;1!==Object.keys(this.parentField.items.registered).length&&(this.removeHTML(),e=this.$el.find("td").length+1,this.$el.after('<tr class="wpforms-conversational-field-item-additional-html"><td colspan="'+e+'">'+wpforms_conversational_forms.html.likert_scale+"</td></tr>"))},j.prototype.getValidateEl=function(){return this.$el.find("input")},j),RecaptchaHidden:function(e,t,i,n){a.FieldItem.call(this,e,t,i,n),this.events.enable={keyboardInput:{$el:this.$el,handler:"change",fn:function(){"1"===this.$el.val()&&c.scroll.to(r.footer).then(function(){r.footer.find(".wpforms-submit").focus()})}}},this.eventsMobile.enable={keyboardInput:this.events.enable.keyboardInput}},StripeCreditCardHiddenInput:(T.prototype.focus=function(){if(this.focusable&&!c.isMobileDevice())try{this.$el.data("stripe-element").focus()}catch(e){}t.mapEvents(this,"keyboard"),this.$el.trigger("wpformsConvFormsFieldItemFocus",this)},T)},fieldItemsSet:{DateTime:(I.prototype.identifyItemType=function(e){if(!(e=!e&&this.current?this.current.$el:e))return"";var t=e.prop("type");return e.hasClass("wpforms-field-date-time-date")&&(t="date"),t=e.hasClass("wpforms-field-date-time-time")?"time":t},I),Signature:(F.prototype.findElements=function(){return[]},F),LikertScale:(E.prototype.findElements=function(){return this.field.$el.find("tbody tr")},E.prototype.identifyItemType=function(){return"likert_row"},E),Recaptcha:(x.prototype.findElements=function(){return this.field.$el.find(".wpforms-recaptcha-hidden")},x.prototype.identifyItemType=function(){return"recaptcha-hidden"},x),StripeCreditCard:(C.prototype.identifyItemType=function(e){return(e=!e&&this.current?this.current.$el:e)?e.hasClass("wpforms-stripe-credit-card-hidden-input")?"stripe-credit-card-hidden-input":e.prop("type"):""},C)},field:{Textarea:(k.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.textarea+"</div>")},k),Checkbox:($.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.checkbox+"</div>")},$),Radio:function(e,t){a.Field.call(this,e,t),this.keyboard.enable={alphabet:{$el:o(s),handler:"keydown",fn:function(e){var t=this.$el.find('input[type="radio"]'),e=e.keyCode-65;t[e]&&o(t[e]).trigger("click")}}}},FileUpload:(w.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.file_upload+"</div>")},w),Rating:function(e,t){a.Field.call(this,e,t),this.keyboard.disable={up:c.globalEvents.keyboard.up,down:c.globalEvents.keyboard.down},this.keyboard.enable={numeric:{$el:o(s),handler:"keydown",fn:function(e){var t,i=this.items.registered;e.keyCode&&(e=String.fromCharCode(e.keyCode),isNaN(parseInt(e,10))||(this.vars.keyBuffer=this.vars.keyBuffer||"",this.vars.keyBuffer+=e,(t=(t=l.object.getKeyByNumIndex(i,parseInt(this.vars.keyBuffer,10)-1))||l.object.getKeyByNumIndex(i,parseInt(e,10)-1))&&(this.vars.timer&&clearTimeout(this.vars.timer),this.vars.timer=setTimeout(function(){delete this.vars.keyBuffer,delete this.vars.timer,t.$el.trigger("click")}.bind(this),250))))}},up:{$el:o(s),handler:"keydown",fn:function(e){38===e.keyCode&&(e.preventDefault(),c.scroll.prev())}},down:{$el:o(s),handler:"keydown",fn:function(e){40===e.keyCode&&(e.preventDefault(),c.scroll.next())}}}},NetPromoterScore:function(e,t){a.Field.call(this,e,t),this.keyboard.disable={up:c.globalEvents.keyboard.up,down:c.globalEvents.keyboard.down},this.keyboard.enable={numeric:{$el:o(s),handler:"keydown",fn:function(e){var t,i=this.items.registered;e.keyCode&&(e=String.fromCharCode(e.keyCode),isNaN(parseInt(e,10))||(this.vars.keyBuffer=this.vars.keyBuffer||"",this.vars.keyBuffer+=e,(t=(t=l.object.getKeyByNumIndex(i,this.vars.keyBuffer))||l.object.getKeyByNumIndex(i,e))&&(this.vars.timer&&clearTimeout(this.vars.timer),this.vars.timer=setTimeout(function(){delete this.vars.keyBuffer,delete this.vars.timer,t.$el.trigger("click")}.bind(this),250))))}},up:{$el:o(s),handler:"keydown",fn:function(e){38===e.keyCode&&(e.preventDefault(),c.scroll.prev())}},down:{$el:o(s),handler:"keydown",fn:function(e){40===e.keyCode&&(e.preventDefault(),c.scroll.next())}}}},LikertScale:function(e,t){a.Field.call(this,e,t),this.keyboard.disable={enter:c.globalEvents.keyboard.enter,left:c.globalEvents.keyboard.left,right:c.globalEvents.keyboard.right},this.keyboard.enable={numeric:{$el:o(s),handler:"keydown",fn:function(e){var t;!this.items.current||(t=this.items.current.$el.find("input"))[e=e.keyCode-49]&&o(t[e]).siblings("label").trigger("click")}},enter:{$el:o(s),handler:"keydown",fn:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),c.scroll.next())}},left:{$el:o(s),handler:"keydown",fn:function(e){37===e.keyCode&&e.preventDefault()}},right:{$el:o(s),handler:"keydown",fn:function(e){39===e.keyCode&&e.preventDefault()}}},this.events.enable={activateFirstRow:{$el:this.$el,handler:"wpformsConvFormsFieldActivationAfter",fn:function(){this.items.highlightNext()}},validation:{$el:this.$el,handler:"wpformsConvFormsFieldValidation",fn:function(e,t){t.length&&t[0]in this.items.registered&&(this.items.setCurrent(this.items.registered[t[0]]),this.items.current.fadeIn())}}},this.eventsMobile.enable={validation:this.events.enable.validation}},Html:(g.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},g),Divider:(b.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},b),PaymentSingle:(y.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},y),PaymentTotal:(m.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},m)}},i={keyboard:{enter:{$el:o(s),handler:"keydown",fn:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),c.fields.isAtBaseline(r.footer)?r.footer.find(".wpforms-submit").trigger("click"):c.fields.callOnActive("isCurrentHighlighted")?c.fields.active.items.selectCurrent():c.scroll.next())}},space:{$el:o(s),handler:"keydown",fn:function(e){32===e.keyCode&&(c.fields.active.items.current.focusable||(e.preventDefault(),c.fields.callOnActive("isCurrentHighlighted")&&c.fields.active.items.selectCurrent()))}},tab:{$el:o(s),handler:"keydown",fn:function(e){if(9===e.keyCode&&!e.shiftKey){e.preventDefault();try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}}if(9===e.keyCode&&e.shiftKey){e.preventDefault();try{c.fields.active.items.highlightPrev().fail(c.scroll.prev)}catch(e){c.scroll.prev()}}}},esc:{$el:o(s),handler:"keydown",fn:function(e){27===e.keyCode&&c.fields.callOnActive("isCurrentHighlighted")&&(c.fields.active.items.setCurrent(),c.fields.active.items.initCurrent())}},up:{$el:o(s),handler:"keydown",fn:function(e){if(38===e.keyCode){e.preventDefault();var t=function(){c.scroll.prev(),c.fields.active&&c.fields.active.items&&c.fields.active.items.highlightPrev()};try{c.fields.active.items.highlightPrev().fail(t)}catch(e){t()}}}},down:{$el:o(s),handler:"keydown",fn:function(e){if(40===e.keyCode){e.preventDefault();var t=function(){c.scroll.next(),c.fields.active&&c.fields.active.items&&c.fields.active.items.highlightNext()};try{c.fields.active.items.highlightNext().fail(t)}catch(e){t()}}}},left:{$el:o(s),handler:"keydown",fn:function(e){37===e.keyCode&&(c.fields.active.items.current.focusable||(e.preventDefault(),c.fields.callOnActive("highlightPrev")))}},right:{$el:o(s),handler:"keydown",fn:function(e){39===e.keyCode&&(c.fields.active.items.current.focusable||(e.preventDefault(),c.fields.callOnActive("highlightNext")))}}},events:{clickActivateField:{$el:r.fields,handler:"mousedown",fn:function(e){var t=c.fields.active?c.fields.active.id:null,i=o(this).data("field-id")+"-"+o(this).data("field-type");i in c.fields.registered&&i!==t&&(e.preventDefault(),c.scroll.to(c.fields.registered[i]))}}}},n={keyboard:{enter:{$el:o(s),handler:"keydown",fn:function(e){if(13===e.keyCode){e.preventDefault();try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}}}}},events:{clickActivateField:i.events.clickActivateField}},c={fields:null,scroll:f,globalEvents:null,mobileDetect:null,init:function(){c.extendClasses(),this.fields=new a.FieldsSet,"undefined"!=typeof MobileDetect&&(c.mobileDetect=new MobileDetect(s.navigator.userAgent)),this.globalEvents=c.isMobileDevice()?n:i,o(c.ready)},ready:function(){c.hidePreloader(),c.readyToStart()?(c.setup(),c.events()):c.runNotReadyActions()},isMobileDevice:function(){return!!c.mobileDetect&&!!c.mobileDetect.mobile()},extendClasses:function(){o.each(d,function(i,e){o.each(e,function(e,t){l.class.extend(t,a[l.string.toCapitalizedCamelCase(i)])})})},hidePreloader:function(){o("html").removeClass("wpforms-conversational-form-loading")},readyToStart:function(){return!o(".wpforms-confirmation-container").length&&!o(".wpforms-confirmation-container-full").length},runNotReadyActions:function(){o(".wpforms-conversational-form-footer-progress-status-proportion").hide(),o(".wpforms-conversational-form-footer-progress-status-proportion-completed").show(),o(".wpforms-conversational-form-footer-switch-step").hide()},setup:function(){c.addRecaptchaToRegisteredFields(),c.fields.updateRegistered(),c.loadValidation(),c.mapAllGlobalEvents(),c.runInitialActions(),c.fields.updateActive()},events:function(){o(s).on("scroll",c.scroll.passive),o(".wpforms-conversational-btn-start").click(c.scroll.next),o(".wpforms-conversational-form-footer-switch-step-up").click(c.footerStepUpBtnAction),o(".wpforms-conversational-form-footer-switch-step-down").click(c.footerStepDownBtnAction),o(e).on("wpformsProcessConditionalsField",c.updateProgressBar)},addRecaptchaToRegisteredFields:function(){var e;!r.recaptchaContainer.length||(e=r.recaptchaContainer.find(".g-recaptcha")).length&&"invisible"!==e.data("size")&&(r.recaptchaContainer.attr("data-field-type","recaptcha").attr("data-field-id","g"),r.fields=r.fields.add(r.recaptchaContainer))},loadValidation:function(){void 0!==o.fn.validate&&setTimeout(function(){var e=r.form.data("validator");e&&(o.validator.addMethod("wpforms-conversational-forms-date",function(e,t){return this.optional(t)||/^\d{1,2}\/\d{2}\/\d{4}$/.test(e)},o.validator.messages.date),e.settings.focusInvalid=!1,e.settings.ignore=":hidden, .wpforms-conversational-form-dropdown-input input",e.settings.invalidHandler=function(e,t){var i;t.numberOfInvalids()&&t.errorList.length&&((i=o(t.errorList[0].element).closest(".wpforms-field").data("field-id"))+"-"+(t=o(t.errorList[0].element).closest(".wpforms-field").data("field-type"))in c.fields.registered&&c.scroll.to(c.fields.registered[i+"-"+t]))},r.form.on("invalid-form.validate",e.settings.invalidHandler))},0)},mapAllGlobalEvents:function(){o.each(c.globalEvents.events,function(e){c.globalEvents.events[e].$el.on(c.globalEvents.events[e].handler,c.globalEvents.events[e].fn)}),o.each(c.globalEvents.keyboard,function(e){c.globalEvents.keyboard[e].$el.on(c.globalEvents.keyboard[e].handler,c.globalEvents.keyboard[e].fn)})},unmapAllGlobalEvents:function(){o.each(c.globalEvents.events,function(e){c.globalEvents.events[e].$el.off(c.globalEvents.events[e].handler,c.globalEvents.events[e].fn)}),o.each(c.globalEvents.keyboard,function(e){c.globalEvents.keyboard[e].$el.off(c.globalEvents.keyboard[e].handler,c.globalEvents.keyboard[e].fn)})},runInitialActions:function(){c.scroll.isTop()&&!r.phpErrorContainer.length&&0<o(".wpforms-conversational-btn-start").length&&r.page.addClass("wpforms-conversational-form-start"),r.phpErrorContainer.length?c.scroll.to(r.phpErrorContainer):r.fieldsErrors.length&&c.scroll.to(r.fieldsErrors)},updateProgressBar:function(){r.progress.totalCount.length?c.updateProportionProgressBar():c.updatePercentageProgressBar()},updateProportionProgressBar:function(){var e=c.fields.getVisible(),t=Object.keys(e).length,i=c.fields.isAtBaseline(r.footer)?t:c.fields.getCompletedCount(e),e=c.fields.getCompletedPercent(e,i);r.progress.bar.width(e+"%"),r.progress.completed.text(i),r.progress.totalCount.text(t)},updatePercentageProgressBar:function(){var e=c.fields.getCompletedPercent();r.progress.bar.width(e+"%"),r.progress.completed.text(e)},footerStepUpBtnAction:function(){var e=c.fields.callOnActive("identifyItemType");if(-1===["checkbox","radio"].indexOf(e))try{c.fields.active.items.highlightPrev().fail(c.scroll.prev)}catch(e){c.scroll.prev()}else c.scroll.prev()},footerStepDownBtnAction:function(){var e=c.fields.callOnActive("identifyItemType");if(-1===["checkbox","radio"].indexOf(e))try{c.fields.active.items.highlightNext().fail(c.scroll.next)}catch(e){c.scroll.next()}else c.scroll.next()}}}(document,window,jQuery);WPFormsConversationalForms.init();